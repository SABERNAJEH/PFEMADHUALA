name: üõ°Ô∏è Kubernetes Security Pipeline

on:
  push:
    branches: [master]
  pull_request:
    branches: [master]
  workflow_dispatch:

jobs:
  notifications:
    uses: ./.github/workflows/notification-job.yml
    secrets:
      EMAIL_TO: "saber.fraj@etudiant-isi.utm.tn,najah.wchem@etudiant-isi.utm.tn"
      EMAIL_FROM: ${{ secrets.GMAIL_USERNAME }}
      EMAIL_PWD: ${{ secrets.GMAIL_PASSWORD }}
  
  security-scan:
    needs: notifications
    uses: ./.github/workflows/scanning-job.yml
    secrets:
      EMAIL_FROM: ${{ secrets.GMAIL_USERNAME }}
      EMAIL_PWD: ${{ secrets.GMAIL_PASSWORD }}
      REPORT_TO: ${{ secrets.REPORT_EMAIL }}
  security-validation:
    runs-on: ubuntu-22.04
    steps:
      - name: Wait for 10 seconds
        run: timeout¬†/T¬†10¬†/NOBREAK
    
  
  
